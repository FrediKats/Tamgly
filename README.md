# Tamgly. Yet another time tracker

## Мотивация

![image](https://user-images.githubusercontent.com/22368203/161392403-67a62364-7420-4d5e-8145-5d12e2920195.png)

Цель: повысить качество планирования и управления задачами. Научиться отвечать на вопрос “сколько времени нужно на реализацию фичи?”

Задачи:

1. Выявлять задачи, которые заняли больше времени чем планировалось и другие проблемы, которые создают расхождение между эстимейтами и реально затраченным временем
2. Автоматизация подсчёта необходимого времени на выполнение задачи с учётом порядка выполнения и рабочих часов
3. Отслеживание нагрузки на день, неделю и месяц для выявления ситуаций, когда запланировано больше задач чем есть доступного времени
4. Подсчёт суммарных эстимейтов по группе задач с учётом блокировок и возможностей параллельно выполнять
5. Построение зависимости времени выполнения задачи от её приоритета

# Сущности

- Задача (оно же та... Oh wait, нельзя в шарпе таски тасками называть). Описывает необходимость выполнить какую-то активность. Описывается заголовком, деталями, идентификатором, статусом (выполнена ли), назанченным сотрудником, списком блокирующих задач, принадлежностью к проекту, эстимейтами, затраченны временем.
- Временной интервал - зарегестрированный в системе отрезок времени в которым выполнялась какая-то активность. Ассоциирован с задачами, задачи агреггируют такие интервалы.
- Митинг (или как-то обыграть интервалы) - записи в календаре как задачи
- Проект - группа задач. Может иметь лимит времени, которое должно быть затрекано за определённый интервал - неделю или месяц.
- Эстимейт - время, которое планируется потратить на выполнение.
- Приоритет - числовое значение, которое описывает порядок выполнения. Можем быть в интервале от 1 до 5. Задачи с 1 приоритетом должны выполнять раньше, чем с 5. Если задача с 3 приоритетом блокирует задачу 1 приоритета, то она должна считаться также 1 приоритетом.

# Технические детали

Прототип планируется реализовать как приложение для одного пользователя, без поддержки команд и шаринга. Реализовавываться будет в качестве консольного приложения.

## Что есть время?

Одна из идей - поддержать возможность ставить задачи на интервалы - день, неделя, месяц. Понимать это можно как “я хочу выполнить на этой неделе эту задачу, но не знаю когда точно. Когда будет время свободное - тогда и попробую взять”. Список задач на интервал будем называть интервальным беклогом.

С днями всё просто. Мы говорим, что у задачи есть дедлайн - какой-то день. Значит беклог этого дня - все задачи, которым дедлайном поставили этот день. При этом, нас будут интересовать в этот день также задачи из недельного беклога т.к. если у нас будет свободное время, то можно будет оттуда взять задачу. Аналогично с месячными.

С недельными интервалами всё сложнее. Начало конец определить можно, но как задавать их? Более того, для единообразия хотелось бы уметь задавать дедлайн как пара из (тип дедлайна, значение дедлайна). Текущий вариант состоит в том, чтобы считать недели номером начиная с какой-то даты в прошлом. Такое допущение имеет смысл, если мы запрещаем в прошлое задавать дедлайн. Для этого есть абстракция TamglyWeek. За нулевую дату взят DateTime(2021, 12, 27); как последний понедельник прошлого года. Чтобы посчитать какой сейчас TamglyWeek, нужно отнять от текущей даты нулевую дату и поделить на 7.

С месячным интервалом ситуация аналогичная, как и с недельными. Нужно считать месяц относительно нулевой даты.

# План работ (MVP)

1. Управление задачами и проектами. Возможность создавать в системе задачи, отмечать их как выполненные.  Интеграция с MS Todo для возможности просмотра задачи там.
2. Отслеживание времени выполнения задачи. Интеграция с Clockify.
3. Возможность задавать эстимейты по задача, просматривать информацию о расхождении эстимейтов и затраченного времени.
4. Беклоги задач на день, неделю или месяц, отслеживание выпавших задач, ситуаций, когда на задачу уже не хватает времени
5. Чеклисты (дейли, викли) со списком задач, которые нужно не забывать выполнить регулярно. Поддержка регулярных событий как задач, учёт их в подсчёте эстимейтов
6. Приоритеты задач, блокирующие задачи, подбор задач по приоритетам и блокировка. Возможность указывать, что задача выполняется внешним исполнителе (для того, чтобы явно указать, что другая задача этим заблокирована
7. Возможность задавать количество часов которое должно выделяться на задачу или проект.
8. Алгоритм оценивания эстимейтов с учётом выбранного приоритета, который позволит понять когда может быть выполнена задача с учётом текущей нагрузки и приоритета задачи.

# Реквайременты

## Добавление задачи

Требуется поддержать CRUD для задач.

1. Возможность создавать задачу. Задача должна описываться идентификатором, названием, описанием (вариативно), статусом.
2. Подключить EF для хранения задач, добавить LazyLoading

## Добавление проектов

Требуется поддержать CRUD для проектов

1. Возможность создавать проекты, добавлять в них задачи
2. Возможность просматривать задачи проекта, делать выборку задач по проектам

## Реализовать возможность указывать затраченное время и эстимейты

1. Добавить возможность указывать в таске затраченное время. Время указывается интервалами в которые происходила работа над таской - от и до. Возможность редактировать уже добавленное время.
2. Добавить возможность указывать эстимейты по таске, определять задачи, которые были выполненный с расхождением эстимейта и затраченного времени (дельту в процентах определять в конфиге)

## Интервальные беклоги

1. Добавить возможность формировать беклог на день, т.е. привязывать задачу к дате выполнения.
2. Добавить возможность указывать, что задачу нужно выполнить на этой неделе/след неделе/какой-то другой неделе. При получении дейли беклога отдельно отображать задачи, которые нужно выполнить на этой неделе
3. Добавить возомжность указывать, что задачу нужно выполнить в этом месяце/след месяце/каком-то месяце. При получении дейли и викли беклога отдельно отображать задачи, которые нужно выполнить в этом месяце
4. Добавить подсчёт суммарных эстимейтов по беклогу.
    1. Для дейли беклога считать
        1. Сумму эстимейтов на этот день
        2. Сумму эстимейтов на этот день + сумму эстимейтов на эту неделю делённую на кол-во дней, которые остались
        3. Сумму эстимейтов на этот день + ... + сумму эстимейтов на этот месяц делённую на кол-во дней, которые остались
    2. Для викли беклога
        1. Считать по каждому дню эстимейт
        2. Эстимейт задач на этой неделе
        3. Средняя сумма эстимейтов на неделе с учётом/без учёта задач на неделю

## Поддержка периодических задач

1. Поддержать возможность заводить задачи, которые появляются каждый день/каждую неделю.
2. Поддержать учёт периодических задач с беклогах
    1. автоматически их туда добавлять, правильно считать суммарные эстимейты

## Блокировки и приоритеты

1. Реализовать возможность указывать, что задача блочит другую задачу.
    1. Добавить в задачу свойство “заблокирована”, если есть хоть одна не выполненная задача, которая блочит
2. Возможность указывать, что задача выполняется внешним исполнителе (для того, чтобы явно указать, что другая задача этим заблокирована
3. Добавить возможность указывать приоритеты задачи
4. Реализовать подсчёт приоритетов в учётом блокировки.
    1. Если задача блочит более приоритетную задачу, то для неё должен дополнительно вычитывать приоритет по более приоритетной задаче
5. Во всех списках задач добавить возможность генерировать список задач в порядке приоритета

## Рабочие часы

1. Возможность задавать количество часов которое должно выделяться на задачу или проект.
    1. Например, 8 часов в день или 40 часов в неделю
2. Реализовать алгоритм нахождения ситуаций, когда на день или неделю запланировано больше чем кол-во рабочий часов

## Калькулятор эстимейтов

1. Реализовать алгоритм, который бы мог посчитать через сколько дней будет выполнена задача с определённым эстимейтов и приоритетом.
    1. Он должен выстроить все текущие задачи в список по приоритетам и с учётом рабочих часов посчитать сколько будет свободного времени, когда закончится выполненеие, если в это время заниматься этой задачей.
2. При добавлении новой задачи, считать какие задачи буду выпадать за пределы их изначальных дедлайнов или ожидаемых даты выполнения
